<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">

<head>
  <meta name="viewport" content="width=device-width; initial-scale=1.0;">
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>Put This In Your Pipe</title>
  <meta name="author" content="Jeff Bezanson, Stefan Karpinski, Viral Shah, Alan Edelman, et al." />
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/custom.css" type="text/css" media="screen, projection" />

  <!-- 단어 단위 줄바꿈  -->
  <script type="text/javascript" src="/js/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="/js/jquery.word-break-keep-all.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('p').wordBreakKeepAll();
    });
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110655381-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-110655381-1'); // juliakorea 추적 ID
  </script>
</head>

<body>
  <div id="site" class="site">
    
    <div class="title"><a href="/">
<svg version="1.1" id="Layer_1"
	 xmlns="http://www.w3.org/2000/svg"
	 xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="210px" height="142px" viewBox="0 0 310 216" enable-background="new 0 0 310 216"
	 xml:space="preserve">

<!-- blue dot -->
<circle fill="#6b85dd" stroke="#4266d5" stroke-width="3" cx="50.5" cy="60" r="16.5"/>
<!-- red dot -->
<circle fill="#d66661" stroke="#c93d39" stroke-width="3" cx="212.459" cy="60" r="16.5"/>
<!-- green dot -->
<circle fill="#6bab5b" stroke="#3b972e" stroke-width="3" cx="233.834" cy="23.874" r="16.5"/>
<!-- purple dot -->
<circle fill="#aa7dc0" stroke="#945bb0" stroke-width="3" cx="255.209" cy="60" r="16.5"/>

<!-- "j" -->
<path fill="#252525" d="M37.216,138.427c0-15.839,0.006-31.679-0.018-47.517c-0.001-0.827,0.169-1.234,1.043-1.47
	c7.876-2.127,15.739-4.308,23.606-6.47c1.33-0.366,1.333-0.36,1.333,1.019c0,25.758,0.015,51.517-0.012,77.274
	c-0.006,5.514,0.245,11.032-0.272,16.543c-0.628,6.69-2.15,13.092-6.438,18.506c-3.781,4.771-8.898,7.25-14.767,8.338
	c-6.599,1.222-13.251,1.552-19.934,0.938c-4.616-0.423-9.045-1.486-12.844-4.363c-2.863-2.168-4.454-4.935-3.745-8.603
	c0.736-3.806,3.348-5.978,6.861-7.127c2.262-0.74,4.628-0.872,6.994-0.53c1.823,0.264,3.42,1.023,4.779,2.288
	c1.38,1.284,2.641,2.674,3.778,4.177c0.872,1.15,1.793,2.256,2.991,3.086c2.055,1.426,4,0.965,5.213-1.216
	c0.819-1.473,0.997-3.106,1.173-4.731c0.255-2.348,0.255-4.707,0.256-7.062C37.218,167.145,37.216,152.786,37.216,138.427z"/>

<!-- "u" -->
<path fill="#252525" d="M125.536,162.479c-2.908,2.385-5.783,4.312-8.88,5.904c-10.348,5.323-20.514,4.521-30.324-1.253
	c-6.71-3.95-11.012-9.849-12.52-17.606c-0.236-1.213-0.363-2.438-0.363-3.688c0.01-19.797,0.017-39.593-0.02-59.39
	c-0.002-1.102,0.285-1.357,1.363-1.351c7.798,0.049,15.597,0.044,23.396,0.003c0.95-0.005,1.177,0.25,1.175,1.183
	c-0.027,19.356-0.025,38.713-0.018,58.07c0.002,6.34,3.599,10.934,9.672,12.42c2.13,0.521,4.19,0.396,6.173-0.6
	c4.26-2.139,7.457-5.427,10.116-9.307c0.333-0.487,0.224-1,0.224-1.51c0.007-19.635,0.016-39.271-0.02-58.904
	c-0.002-1.083,0.255-1.369,1.353-1.361c7.838,0.052,15.677,0.045,23.515,0.004c0.916-0.005,1.103,0.244,1.102,1.124
	c-0.025,27.677-0.026,55.353,0.002,83.024c0.001,0.938-0.278,1.099-1.139,1.095c-7.918-0.028-15.837-0.028-23.756-0.001
	c-0.815,0.003-1.1-0.166-1.073-1.037C125.581,167.117,125.536,164.928,125.536,162.479z"/>

<!-- "l" -->
<path fill="#252525" d="M187.423,107.08c0,20.637-0.011,41.273,0.026,61.91c0.003,1.119-0.309,1.361-1.381,1.355
	c-7.799-0.052-15.598-0.047-23.396-0.008c-0.898,0.008-1.117-0.222-1.115-1.115c0.021-39.074,0.021-78.147,0-117.226
	c0-0.811,0.189-1.169,1.006-1.392c7.871-2.149,15.73-4.327,23.584-6.545c1.045-0.295,1.308-0.17,1.306,0.985
	C187.412,65.727,187.423,86.403,187.423,107.08z"/>

<!-- "i" -->
<path fill="#252525" d="M223.46,126.477c0,14.155-0.011,28.312,0.021,42.467c0.002,1.027-0.164,1.418-1.332,1.408
	c-7.838-0.061-15.676-0.047-23.516-0.01c-0.881,0.004-1.121-0.189-1.119-1.104c0.026-26.153,0.025-52.307,0-78.458
	c0-0.776,0.203-1.101,0.941-1.302c7.984-2.172,15.972-4.35,23.938-6.596c1.049-0.296,1.08,0.031,1.078,0.886
	C223.454,98.004,223.46,112.239,223.46,126.477z"/>

<!-- "a" -->
<path fill="#252525" d="M277.695,163.6c-0.786,0.646-1.404,1.125-2,1.635c-4.375,3.746-9.42,5.898-15.16,6.42
	c-5.792,0.527-11.479,0.244-16.934-2.047c-12.08-5.071-15.554-17.188-11.938-27.448c1.799-5.111,5.472-8.868,9.831-11.94
	c5.681-4.003,12.009-6.732,18.504-9.074c5.576-2.014,11.186-3.939,16.955-5.347c0.445-0.104,0.773-0.243,0.757-0.854
	c-0.136-4.389,0.261-8.79-0.479-13.165c-1.225-7.209-6.617-10.013-12.895-9.348c-0.516,0.055-1.029,0.129-1.536,0.241
	c-4.877,1.081-7.312,4.413-7.374,10.127c-0.02,1.729-0.229,3.418-0.693,5.084c-0.906,3.229-2.969,5.354-6.168,6.266
	c-3.422,0.979-6.893,0.998-10.23-0.305c-6.529-2.543-8.877-10.164-5.12-16.512c2.249-3.799,5.606-6.4,9.461-8.405
	c6.238-3.246,12.914-4.974,19.896-5.537c7.565-0.61,15.096-0.366,22.49,1.507c4.285,1.085,8.312,2.776,11.744,5.657
	c4.473,3.749,6.776,8.647,6.812,14.374c0.139,21.477,0.096,42.951,0.143,64.428c0.002,0.799-0.248,0.983-1.021,0.98
	c-8.035-0.025-16.074-0.023-24.113-0.001c-0.716,0.002-0.973-0.146-0.941-0.915C277.736,167.562,277.695,165.698,277.695,163.6z
	 M277.695,126.393c-4.793,2.104-9.25,4.373-13.287,7.408c-2.151,1.618-4.033,3.483-5.732,5.581
	c-4.229,5.226-1.988,13.343,1.693,16.599c1.592,1.406,3.359,1.906,5.419,1.521c1.621-0.307,3.149-0.857,4.549-1.734
	c1.521-0.951,2.949-2.072,4.539-2.887c2.31-1.18,2.97-2.861,2.894-5.445C277.561,140.484,277.695,133.527,277.695,126.393z"/>

</svg>

</a></div>

<ul class="links">
  
      
      
      
      
      
      <li><a href="/" class="">홈</a></li>
  
      
      
      
      
      
      <li><a href="https://github.com/JuliaLang/julia" class="">소스코드</a></li>
  
      
      
      
      
      
      <li><a href="/downloads/" class="">다운로드</a></li>
  
      
      
      
      
      
      <li><a href="/ko/" class="">문서</a></li>
  
      
      
      
      
      
      <li><a href="http://pkg.julialang.org/" class="">패키지</a></li>
  
      
      
      
      
      
      <li><a href="/blog/" class="active">블로그</a></li>
  
      
      
      
      
      
      <li><a href="/community/" class="">커뮤니티</a></li>
  
      
      
      
      
      
      <li><a href="/ecosystems" class="">생태계</a></li>
  
      
      
      
      
      
      <li><a href="/learning/" class="">배우기</a></li>
  
      
      
      
      
      
      <li><a href="/teaching/" class="">강의</a></li>
  
      
      
      
      
      
      <li><a href="/publications/" class="">논문</a></li>
  
      
      
      
      
      
      <li><a href="/soc/ideas-page.html" class="">GSoC</a></li>
  
      
      
      
      
      
      <li><a href="http://juliacon.org" class="">줄리아콘</a></li>
  
</ul>

<!--

<style>
.banner-box .header {
  font-size: 1.5em;
}
@media (min-width: 830px) {
  .banner-box {
    float:left;
    width:50%;
  }
}
</style>

<div style="text-align:center">

<div class="banner-box">
<div class="header">JuliaCon 2016</div>
<p>
  Held on June 21<sup>st</sup> - 25<sup>th</sup> at MIT<br>
  <a href="http://juliacon.org">talks</a> |
  <a href="https://www.youtube.com/playlist?list=PLP8iPy9hna6SQPwZUDtAM59-wPzCPyD_S">videos</a>
</p>
</div>

<div class="banner-box">
<div class="header">Google Summer of Code</div>
<p>
  Julia gets 12 slots in the Google Summer of Code!<br />
  <a href="https://summerofcode.withgoogle.com/organizations/6453977159827456/">projects</a> |
  <a href="/soc/ideas-page.html">ideas list</a>
</p>
</div>

<div style="clear:both; border-top: 1px solid #ddd; margin-bottom:30px;"></div>


</div>
-->


<div id="blogpost">
  <h1>Put This In Your Pipe</h1>

  <p class="metadata">
    <span class="timestamp">08 Apr 2013</span>
    
    &nbsp;|&nbsp;
    <span class="author"><a href="http://karpinski.org/">Stefan Karpinski</a></span>
    
  </p>

  
<p>In a <a href="http://julialang.org/blog/2012/03/shelling-out-sucks">previous post</a>, I talked about why “shelling out” to spawn a pipeline of external programs via an intermediate shell is a common cause of bugs, security holes, unnecessary overhead, and silent failures.
But it’s so convenient!
Why can’t running pipelines of external programs be convenient <em>and</em> safe?
Well, there’s no real reason, actually.
The shell itself manages to construct and execute pipelines quite well.
In principle, there’s nothing stopping high-level languages from doing it at least as well as shells do – the common ones just don’t by default, instead requiring users to make the extra effort to use external programs safely and correctly.
There are two major impediments:</p>

<ul>
  <li>Some moderately tricky low-level UNIX plumbing using the <a href="https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/pipe.2.html"><code class="highlighter-rouge">pipe</code></a>, <a href="https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/dup2.2.html"><code class="highlighter-rouge">dup2</code></a>, <a href="https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/fork.2.html"><code class="highlighter-rouge">fork</code></a>, <a href="https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/close.2.html"><code class="highlighter-rouge">close</code></a>, and <a href="https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man2/execve.2.html"><code class="highlighter-rouge">exec</code></a> system calls;</li>
  <li>The UX problem of designing an easy, flexible programming interface for commands and pipelines.</li>
</ul>

<p>This post describes the system we designed and implemented for Julia, and how it avoids the major flaws of shelling out in other languages.
First, I’ll present the Julia version of the previous post’s example – counting the number of lines in a given directory containing the string “foo”.
The fact that Julia provides complete, specific diagnostic error messages when pipelines fail turns out to reveal a surprising and subtle bug, lurking in what appears to be a perfectly innocuous UNIX pipeline.
After fixing this bug, we go into details of how Julia’s external command execution and pipeline construction system actually works, and why it provides greater flexibility and safety than the traditional approach of using an intermediate shell to do all the heavy lifting.</p>

<h2 id="simple-pipeline-subtle-bug">Simple Pipeline, Subtle Bug</h2>

<p>Here’s how you write the example of counting the number of lines in a directory containing the string “foo” in Julia
(you can follow along at home if you have Julia installed from source by changing directories into the Julia source directory and doing <code class="highlighter-rouge">cp -a src "source code"; mkdir tmp</code> and then firing up the Julia repl):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "src";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; `xargs -0 grep foo` |&gt; `wc -l`))
5
</code></pre></div></div>

<p>This Julia command looks suspiciously similar to the naïve Ruby version we started with in the previous post:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`find #{dir} -type f -print0 | xargs -0 grep foo | wc -l`.to_i
</code></pre></div></div>

<p>However, it isn’t susceptible to the same problems:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "source code";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; `xargs -0 grep foo` |&gt; `wc -l`))
5

julia&gt; dir = "nonexistent";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; `xargs -0 grep foo` |&gt; `wc -l`))
find: `nonexistent': No such file or directory
ERROR: failed processes:
  Process(`find nonexistent -type f -print0`, ProcessExited(1)) [1]
  Process(`xargs -0 grep foo`, ProcessExited(123)) [123]
 in pipeline_error at process.jl:412
 in readall at process.jl:365
 in readchomp at io.jl:172

julia&gt; dir = "foo'; echo MALICIOUS ATTACK; echo '";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; `xargs -0 grep foo` |&gt; `wc -l`))
find: `foo\'; echo MALICIOUS ATTACK; echo \'': No such file or directory
ERROR: failed processes:
  Process(`find "foo'; echo MALICIOUS ATTACK; echo '" -type f -print0`, ProcessExited(1)) [1]
  Process(`xargs -0 grep foo`, ProcessExited(123)) [123]
 in pipeline_error at process.jl:412
 in readall at process.jl:365
 in readchomp at io.jl:172
</code></pre></div></div>

<p>The default, simplest-to-achieve behavior in Julia is:</p>

<ul>
  <li>not susceptible to any kind of metacharacter breakage,</li>
  <li>reliably detects all subprocess failures,</li>
  <li>automatically raises an exception if any subprocess fails,</li>
  <li>prints error messages including exactly which commands failed.</li>
</ul>

<p>In the above examples, we can see that even when <code class="highlighter-rouge">dir</code> contains spaces or quotes, the expression still behaves exactly as intended – the value of <code class="highlighter-rouge">dir</code> is interpolated as a single argument to the <code class="highlighter-rouge">find</code> command.
When <code class="highlighter-rouge">dir</code> is not the name of a directory that exists, <code class="highlighter-rouge">find</code> fails – as it should – and this failure is detected and automatically converted into an informative exception, including the fully expanded command-lines that failed.</p>

<p>In the previous post, we observed that using the <code class="highlighter-rouge">pipefail</code> option for Bash allows detection of pipeline failures, like this one, occurring before the last process in the pipeline.
However, it only allows us to detect that at least one thing in the pipeline failed.
We still have to guess at what parts of the pipeline actually failed.
In the Julia example, on the other hand, there is no guessing required:
when a non-existent directory is given, we can see that both <code class="highlighter-rouge">find</code> and <code class="highlighter-rouge">xargs</code> fail.
While it is unsurprising that <code class="highlighter-rouge">find</code> fails in this case, it is unexpected that <code class="highlighter-rouge">xargs</code> also fails.
Why <em>does</em> <code class="highlighter-rouge">xargs</code> fail?</p>

<p>One possibility to check for is that the <code class="highlighter-rouge">xargs</code> program fails with no input.
We can use Julia’s <code class="highlighter-rouge">success</code> predicate to try it out:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; success(`cat /dev/null` |&gt; `xargs true`)
true
</code></pre></div></div>

<p>Ok, so <code class="highlighter-rouge">xargs</code> seems perfectly happy with no input.
Maybe grep doesn’t like not getting any input?</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; success(`cat /dev/null` |&gt; `grep foo`)
false
</code></pre></div></div>

<p>Aha! <code class="highlighter-rouge">grep</code> returns a non-zero status when it doesn’t get any input.
Good to know.
It turns out that <code class="highlighter-rouge">grep</code> indicates whether it matched anything or not with its return status.
Most programs use their return status to indicate success or failure, but some, like <code class="highlighter-rouge">grep</code>, use it to indicate some other boolean condition – in this case “found something” versus “didn’t find anything”:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; success(`echo foo` |&gt; `grep foo`)
true

julia&gt; success(`echo bar` |&gt; `grep foo`)
false
</code></pre></div></div>

<p>Now we know why <code class="highlighter-rouge">grep</code> is “failing” – and <code class="highlighter-rouge">xargs</code> too, since it returns a non-zero status if the program it runs returns non-zero.
This means that our Julia pipeline and the “responsible” Ruby version are both susceptible to bogus failures when we search an existing directory that happens not to contain the string “foo” anywhere:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "tmp";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; `xargs -0 grep foo` |&gt; `wc -l`))
ERROR: failed process: Process(`xargs -0 grep foo`, ProcessExited(123)) [123]
 in error at error.jl:22
 in pipeline_error at process.jl:394
 in pipeline_error at process.jl:407
 in readall at process.jl:365
 in readchomp at io.jl:172
</code></pre></div></div>

<p>Since <code class="highlighter-rouge">grep</code> indicates not finding anything using a non-zero return status, the <code class="highlighter-rouge">readall</code> function concludes that its pipeline failed and raises an error to that effect.
In this case, this default behavior is undesirable:
we want the expression to just return <code class="highlighter-rouge">0</code> without raising an error.
The simple fix in Julia is this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "tmp";

julia&gt; int(readchomp(`find $dir -type f -print0` |&gt; ignorestatus(`xargs -0 grep foo`) |&gt; `wc -l`))
0
</code></pre></div></div>

<p>This works correctly in all cases.
Next I’ll explain <em>how</em> all of this works, but for now it’s enough to note that the detailed error message provided when our pipeline failed exposed a rather subtle bug that would eventually cause subtle and hard-to-debug problems when used in production.
Without such detailed error reporting, this bug would be pretty difficult to track down.</p>

<h2 id="do-nothing-backticks">Do-Nothing Backticks</h2>

<p>Julia borrows the backtick syntax for external commands form Perl and Ruby, both of which in turn got it from the shell.
Unlike in these predecessors, however, in Julia backticks don’t immediately run commands, nor do they necessarily indicate that you want to capture the output of the command.
Instead, backticks just construct an object representing a command:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; `echo Hello`
`echo Hello`

julia&gt; typeof(ans)
Cmd
</code></pre></div></div>

<p>(In the Julia repl, <code class="highlighter-rouge">ans</code> is automatically bound to the value of the last evaluated input.)
In order to actually run a command, you have to <em>do</em> something with a command object.
To run a command and capture its output into a string – what other languages do with backticks automatically – you can apply the <code class="highlighter-rouge">readall</code> function:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; readall(`echo Hello`)
"Hello\n"
</code></pre></div></div>

<p>Since it’s very common to want to discard the trailing line break at the end of a command’s output, Julia provides the <code class="highlighter-rouge">readchomp(x)</code> command which is equivalent to writing <code class="highlighter-rouge">chomp(readall(x))</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; readchomp(`echo Hello`)
"Hello"
</code></pre></div></div>

<p>To run a command without capturing its output, letting it just print to the same <code class="highlighter-rouge">stdout</code> stream as the main process – i.e. what the <code class="highlighter-rouge">system</code> function does when given a command as a string in other languages – use the <code class="highlighter-rouge">run</code> function:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; run(`echo Hello`)
Hello
</code></pre></div></div>

<p>The <code class="highlighter-rouge">"Hello\n"</code> after the <code class="highlighter-rouge">readall</code> command is a returned value, whereas the <code class="highlighter-rouge">Hello</code> after the <code class="highlighter-rouge">run</code> command is printed output.
(If your terminal supports color, these are colored differently so that you can easily distinguish them visually.)
Nothing is returned by the <code class="highlighter-rouge">run</code> command, but if something goes wrong, an exception is raised:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; run(`false`)
ERROR: failed process: Process(`false`, ProcessExited(1)) [1]
 in error at error.jl:22
 in pipeline_error at process.jl:394
 in run at process.jl:384

julia&gt; run(`notaprogram`)
execvp(): No such file or directory
ERROR: failed process: Process(`notaprogram`, ProcessExited(-1)) [-1]
 in error at error.jl:22
 in pipeline_error at process.jl:394
 in run at process.jl:384
</code></pre></div></div>

<p>As with <code class="highlighter-rouge">xargs</code> and <code class="highlighter-rouge">grep</code> above, this may not always be desirable.
In such cases, you can use <code class="highlighter-rouge">ignorestatus</code> to indicate that the command returning a non-zero value should not be considered an error:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; run(ignorestatus(`false`))

julia&gt; run(ignorestatus(`notaprogram`))
execvp(): No such file or directory
ERROR: failed process: Process(`notaprogram`, ProcessExited(-1)) [-1]
 in error at error.jl:22
 in pipeline_error at process.jl:394
 in run at process.jl:384
</code></pre></div></div>

<p>In the latter case, an error is still raised in the parent process since the problem is that the executable doesn’t even exist, rather than merely that it ran and returned a non-zero status.</p>

<p>Although Julia’s backtick syntax intentionally mimics the shell as closely as possible, there is an important distinction:
the command string is never passed to a shell to be interpreted and executed;
instead it is parsed in Julia code, using the same rules the shell uses to determine what the command and arguments are.
Command objects allow you to see what the program and arguments were determined to be by accessing the <code class="highlighter-rouge">.exec</code> field:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; cmd = `perl -e 'print "Hello\n"'`
`perl -e 'print "Hello\n"'`

julia&gt; cmd.exec
3-element Union(UTF8String,ASCIIString) Array:
 "perl"
 "-e"
 "print \"Hello\\n\""
</code></pre></div></div>

<p>This field is a plain old array of strings that can be manipulated like any other Julia array.</p>

<h2 id="constructing-commands">Constructing Commands</h2>

<p>The purpose of the backtick notation in Julia is to provide a familiar, shell-like syntax for making objects representing commands with arguments.
To that end, quotes and spaces work just as they do in the shell.
The real power of backtick syntax doesn’t emerge, however, until we begin constructing commands programmatically.
Just as in the shell (and in Julia strings), you can interpolate values into commands using the dollar sign (<code class="highlighter-rouge">$</code>):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "src";

julia&gt; `find $dir -type f`.exec
4-element Union(UTF8String,ASCIIString) Array:
 "find"
 "src"
 "-type"
 "f"
</code></pre></div></div>

<p>Unlike in the shell, however, Julia values interpolated into commands are interpolated as a single verbatim argument – no characters inside the value are interpreted as special after the value has been interpolated:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "two words";

julia&gt; `find $dir -type f`.exec
4-element Union(UTF8String,ASCIIString) Array:
 "find"
 "two words"
 "-type"
 "f"

julia&gt; dir = "foo'bar";

julia&gt; `find $dir -type f`.exec
4-element Union(UTF8String,ASCIIString) Array:
 "find"
 "foo'bar"
 "-type"
 "f"
</code></pre></div></div>

<p>This works no matter what the contents of the interpolated value is, allowing simple interpolation of characters that are quite difficult to pass as parts of command-line arguments even in the shell (for the following examples, <code class="highlighter-rouge">tmp/a.tsv</code> and <code class="highlighter-rouge">tmp/b.tsv</code> can be created in the shell with <code class="highlighter-rouge">echo -e "foo\tbar\nbaz\tqux" &gt; tmp/a.tsv; echo -e "foo\t1\nbaz\t2" &gt; tmp/b.tsv</code>):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; tab = "\t";

julia&gt; cmd = `join -t$tab tmp/a.tsv tmp/b.tsv`;

julia&gt; cmd.exec
4-element Union(UTF8String,ASCIIString) Array:
 "join"
 "-t\t"
 "tmp/a.tsv"
 "tmp/b.tsv"

julia&gt; run(cmd)
foo     bar     1
baz     qux     2
</code></pre></div></div>

<p>Moreover, what comes after the <code class="highlighter-rouge">$</code> can actually be any valid Julia expression, not just a variable name:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; `join -t$"\t" tmp/a.tsv tmp/b.tsv`.exec
4-element Union(UTF8String,ASCIIString) Array:
 "join"
 "-t\t"
 "a.tsv"
 "b.tsv"
</code></pre></div></div>

<p>A tab character is somewhat harder to pass in the shell, requiring command interpolation and some tricky quoting:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bash-3.2$ join -t"$(printf '\t')" tmp/a.tsv tmp/b.tsv
foo	    bar	    1
baz	    qux	    2
</code></pre></div></div>

<p>While interpolating values with spaces and other strange characters is great for non-brittle construction of commands, there was a reason why the shell split values on spaces in the first place:
to allow interpolation of multiple arguments.
Most modern shells have first-class array types, but older shells used space-separation to simulate arrays.
Thus, if you interpolate a value like “foo bar” into a command in the shell, it’s treated as two separate words by default.
In languages with first-class array types, however, there’s a much better option:
consistently interpolate single values as single arguments and interpolate arrays as multiple values.
This is precisely what Julia’s backtick interpolation does:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dirs = ["foo", "bar", "baz"];

julia&gt; `find $dirs -type f`.exec
6-element Union(UTF8String,ASCIIString) Array:
 "find"
 "foo"
 "bar"
 "baz"
 "-type"
 "f"
</code></pre></div></div>

<p>And of course, no matter how strange the strings contained in an interpolated array are, they become verbatim arguments, without any shell interpretation.
Julia’s backticks have one more fancy trick up their sleeve.
We saw earlier (without really remarking on it) that you could interpolate single values into a larger argument:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; x = "bar";

julia&gt; `echo foo$x`
`echo foobar`
</code></pre></div></div>

<p>What happens if <code class="highlighter-rouge">x</code> is an array?
Only one way to find out:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; x = ["bar", "baz"];

julia&gt; `echo foo$x`
`echo foobar foobaz`
</code></pre></div></div>

<p>Julia does what the shell would do if you wrote <code class="highlighter-rouge">echo foo{bar,baz}</code>.
This even works correctly for multiple values interpolated into the same shell word:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; dir = "/data"; names = ["foo","bar"]; exts=["csv","tsv"];

julia&gt; `cat $dir/$names.$exts`
`cat /data/foo.csv /data/foo.tsv /data/bar.csv /data/bar.tsv`
</code></pre></div></div>

<p>This is the same Cartesian product expansion that the shell does if multiple <code class="highlighter-rouge">{...}</code> expressions are used in the same word.</p>

<h2 id="further-reading">Further Reading</h2>

<p>You can read more in Julia’s <a href="http://docs.julialang.org/en/release-0.1/manual/running-external-programs/">online manual</a>, including how to construct complex pipelines, and how shell-compatible quoting and interpolation rules in Julia’s backtick syntax make it both simple and safe to cut-and-paste shell commands into Julia code.
The whole system is designed on the principle that the easiest thing to do should also be the right thing.
The end result is that starting and interacting with external processes in Julia is both convenient and safe.</p>


</div>



    <div class="footer">
      Julia is a <a href="https://numfocus.org/projects/index.html">NumFocus project</a>.
      We thank <a href="https://fastly.com">Fastly</a> for their generous infrastructural support.
      
      <a href="https://github.com/juliakorea/translate-home/edit/master/src/blog/_posts/2013-04-08-put-this-in-your-pipe.md">Edit this page on GitHub.</a>
    </div>

    <!-- Add "contribute" link to the Transifex language dropdown -->
    <script>
      // Create a link element for the translation prompt
      var txPromptLink = document.createElement( "a" );
      txPromptLink.href = "https://www.transifex.com/julialang-i18n/julialang-web/";
      txPromptLink.appendChild( document.createTextNode( "Add your language!" ) );
      txPromptLink.style.fontWeight = "bold";

      // Wrap the translation prompt link in a list item element
      var txPrompt = document.createElement( "li" );
      txPrompt.appendChild( txPromptLink );

      // Add the translation prompt list item to the list of languages
      document.getElementById( "tx-live-lang-picker" ).appendChild( txPrompt );
    </script>

<!--Flipcause Integration v3.0// Flipcause Integration Instructions:
    Install the following code block once in the website Header (after <head> tag) -->

<style>

  .fc-black_overlay{
  display:none; position: fixed; z-index:1000001; top: 0%;left: 0%;width: 100%;height: 100%;
  background-color: black; filter: alpha(opacity=50); cursor:pointer; opacity:0.5;
  }

  .fc-white_content {
  opacity:1; display:none; margin-top: -320px; margin-left: -485px; width:970px; height:640px;
  position:fixed; top:50%; left:50%; border: none;z-index:1000002;overflow: auto;
  }

  .fc-main-box{
  opacity:1; display:none; margin:15px auto 0 auto; width:930px; position:relative; z-index:1000003;
  }

  .fc-widget_close{
  opacity:1; content:url(http://i1338.photobucket.com/albums/o691/WeCause/X_zpse4a7e538.png);
  position:absolute; z-index=1000004; right:-16px; top:-16px; display:block; cursor:pointer;
  }

  .floating_button{
  display: block; margin-top: 0px; margin-left: 0px; width:auto ; height: auto;
  position:fixed; z-index:999999; overflow: auto;
  }

  @keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-moz-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-webkit-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-o-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }


  @-ms-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; transform: translateY(20px);}
  100% {opacity: 1; transform: translateY(0);}
  }

  @-moz-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -moz-transform: translateY(20px);}
  100% {opacity: 1; -moz-transform: translateY(0);}
  }

  @-webkit-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -webkit-transform: translateY(20px);}
  100% {opacity: 1; -webkit-transform: translateY(0);}
  }

  @-o-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -o-transform: translateY(20px);}
  100% {opacity: 1; -o-transform: translateY(0);}
  }

  @-ms-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -ms-transform: translateY(20px);}
  100% {opacity: 1; -ms-transform: translateY(0);}
  }

</style>

<script>

  function open_window(cause_id) {
  var  protocol=String(document.location.protocol);
  var new_url;
  if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
  new_url="https://www.flipcause.com/widget/"+cause_id
  window.open(new_url);
  }

  else {
  document.getElementById("fc-fade").style.display = "block";
  document.getElementById("fc-fade").style.webkitAnimation = "backfadesin 1s";
  document.getElementById("fc-fade").style.animation = "backfadesin 1s";
  document.getElementById("fc-fade").style.mozAnimation = "backfadesin 1s";
  document.getElementById("fc-light").style.display = "block";
  document.getElementById("fc-light").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-light").style.animation = "fadesin 1.5s";
  document.getElementById("fc-light").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-main").style.display = "block";
  document.getElementById("fc-main").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-main").style.animation = "fadesin 1.5s";
  document.getElementById("fc-main").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-close").style.display = "block";
  document.getElementById("fc-close").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-close").style.animation = "fadesin 1.5s";
  document.getElementById("fc-close").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.display = "block";
  document.getElementById("fc-myFrame").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.animation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").src="https://www.flipcause.com/widget/"+cause_id;
  }
  }


  function close_window() {
  document.getElementById("fc-fade").style.display="none";
  document.getElementById("fc-light").style.display="none";
  document.getElementById("fc-main").style.display="none";
  document.getElementById("fc-close").style.display="none";
  document.getElementById("fc-myFrame").style.display="none";
  }

</script>

<div id="fc-fade" class="fc-black_overlay" onclick="close_window()"></div>
<div id="fc-light" class="fc-white_content">
  <div id="fc-main" class="fc-main-box">
    <div id="fc-close" class="fc-widget_close" onclick="close_window()"></div>
    <iframe id="fc-myFrame" iframe height="580" width="925"
            style="border: 0; border-radius: 5px 5px 5px 5px; box-shadow: 0 0 8px rgba(0, 0, 0, 0.5);"
            scrolling="no" src=""></iframe>
  </div>
</div>

<!--END Flipcause Main Integration Code-->

    <div style="background: #ccc; border-radius: 0px 0px 0px 0px; font-weight: normal;
                font-family: Arial, Helvetica, sans-serif; border: none; box-shadow: none;
                left: 50%; margin-left: -72.5px; clear: both; display: block; width: 145px;
                height: 45px; line-height: 2.8; position: relative; font-size: 16px;
                text-align: center; cursor: pointer; color: #fff; text-decoration: none; z-index:1"
         onclick="open_window('MjI1Nw==')">
      Donate Now
    </div>
    
  </div><!-- main wrapper -->
</body>
</html>
