<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">

<head>
  <meta name="viewport" content="width=device-width; initial-scale=1.0;">
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>JSoC 2015 project: NullableArrays.jl</title>
  <meta name="author" content="Jeff Bezanson, Stefan Karpinski, Viral Shah, Alan Edelman, et al." />
  <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
  <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="/css/custom.css" type="text/css" media="screen, projection" />

  <!-- 단어 단위 줄바꿈  -->
  <script type="text/javascript" src="/js/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="/js/jquery.word-break-keep-all.min.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('p').wordBreakKeepAll();
    });
  </script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110655381-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-110655381-1'); // juliakorea 추적 ID
  </script>
</head>

<body>
  <div id="site" class="site">
    
    <div class="title"><a href="/">
<svg version="1.1" id="Layer_1"
	 xmlns="http://www.w3.org/2000/svg"
	 xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="210px" height="142px" viewBox="0 0 310 216" enable-background="new 0 0 310 216"
	 xml:space="preserve">

<!-- blue dot -->
<circle fill="#6b85dd" stroke="#4266d5" stroke-width="3" cx="50.5" cy="60" r="16.5"/>
<!-- red dot -->
<circle fill="#d66661" stroke="#c93d39" stroke-width="3" cx="212.459" cy="60" r="16.5"/>
<!-- green dot -->
<circle fill="#6bab5b" stroke="#3b972e" stroke-width="3" cx="233.834" cy="23.874" r="16.5"/>
<!-- purple dot -->
<circle fill="#aa7dc0" stroke="#945bb0" stroke-width="3" cx="255.209" cy="60" r="16.5"/>

<!-- "j" -->
<path fill="#252525" d="M37.216,138.427c0-15.839,0.006-31.679-0.018-47.517c-0.001-0.827,0.169-1.234,1.043-1.47
	c7.876-2.127,15.739-4.308,23.606-6.47c1.33-0.366,1.333-0.36,1.333,1.019c0,25.758,0.015,51.517-0.012,77.274
	c-0.006,5.514,0.245,11.032-0.272,16.543c-0.628,6.69-2.15,13.092-6.438,18.506c-3.781,4.771-8.898,7.25-14.767,8.338
	c-6.599,1.222-13.251,1.552-19.934,0.938c-4.616-0.423-9.045-1.486-12.844-4.363c-2.863-2.168-4.454-4.935-3.745-8.603
	c0.736-3.806,3.348-5.978,6.861-7.127c2.262-0.74,4.628-0.872,6.994-0.53c1.823,0.264,3.42,1.023,4.779,2.288
	c1.38,1.284,2.641,2.674,3.778,4.177c0.872,1.15,1.793,2.256,2.991,3.086c2.055,1.426,4,0.965,5.213-1.216
	c0.819-1.473,0.997-3.106,1.173-4.731c0.255-2.348,0.255-4.707,0.256-7.062C37.218,167.145,37.216,152.786,37.216,138.427z"/>

<!-- "u" -->
<path fill="#252525" d="M125.536,162.479c-2.908,2.385-5.783,4.312-8.88,5.904c-10.348,5.323-20.514,4.521-30.324-1.253
	c-6.71-3.95-11.012-9.849-12.52-17.606c-0.236-1.213-0.363-2.438-0.363-3.688c0.01-19.797,0.017-39.593-0.02-59.39
	c-0.002-1.102,0.285-1.357,1.363-1.351c7.798,0.049,15.597,0.044,23.396,0.003c0.95-0.005,1.177,0.25,1.175,1.183
	c-0.027,19.356-0.025,38.713-0.018,58.07c0.002,6.34,3.599,10.934,9.672,12.42c2.13,0.521,4.19,0.396,6.173-0.6
	c4.26-2.139,7.457-5.427,10.116-9.307c0.333-0.487,0.224-1,0.224-1.51c0.007-19.635,0.016-39.271-0.02-58.904
	c-0.002-1.083,0.255-1.369,1.353-1.361c7.838,0.052,15.677,0.045,23.515,0.004c0.916-0.005,1.103,0.244,1.102,1.124
	c-0.025,27.677-0.026,55.353,0.002,83.024c0.001,0.938-0.278,1.099-1.139,1.095c-7.918-0.028-15.837-0.028-23.756-0.001
	c-0.815,0.003-1.1-0.166-1.073-1.037C125.581,167.117,125.536,164.928,125.536,162.479z"/>

<!-- "l" -->
<path fill="#252525" d="M187.423,107.08c0,20.637-0.011,41.273,0.026,61.91c0.003,1.119-0.309,1.361-1.381,1.355
	c-7.799-0.052-15.598-0.047-23.396-0.008c-0.898,0.008-1.117-0.222-1.115-1.115c0.021-39.074,0.021-78.147,0-117.226
	c0-0.811,0.189-1.169,1.006-1.392c7.871-2.149,15.73-4.327,23.584-6.545c1.045-0.295,1.308-0.17,1.306,0.985
	C187.412,65.727,187.423,86.403,187.423,107.08z"/>

<!-- "i" -->
<path fill="#252525" d="M223.46,126.477c0,14.155-0.011,28.312,0.021,42.467c0.002,1.027-0.164,1.418-1.332,1.408
	c-7.838-0.061-15.676-0.047-23.516-0.01c-0.881,0.004-1.121-0.189-1.119-1.104c0.026-26.153,0.025-52.307,0-78.458
	c0-0.776,0.203-1.101,0.941-1.302c7.984-2.172,15.972-4.35,23.938-6.596c1.049-0.296,1.08,0.031,1.078,0.886
	C223.454,98.004,223.46,112.239,223.46,126.477z"/>

<!-- "a" -->
<path fill="#252525" d="M277.695,163.6c-0.786,0.646-1.404,1.125-2,1.635c-4.375,3.746-9.42,5.898-15.16,6.42
	c-5.792,0.527-11.479,0.244-16.934-2.047c-12.08-5.071-15.554-17.188-11.938-27.448c1.799-5.111,5.472-8.868,9.831-11.94
	c5.681-4.003,12.009-6.732,18.504-9.074c5.576-2.014,11.186-3.939,16.955-5.347c0.445-0.104,0.773-0.243,0.757-0.854
	c-0.136-4.389,0.261-8.79-0.479-13.165c-1.225-7.209-6.617-10.013-12.895-9.348c-0.516,0.055-1.029,0.129-1.536,0.241
	c-4.877,1.081-7.312,4.413-7.374,10.127c-0.02,1.729-0.229,3.418-0.693,5.084c-0.906,3.229-2.969,5.354-6.168,6.266
	c-3.422,0.979-6.893,0.998-10.23-0.305c-6.529-2.543-8.877-10.164-5.12-16.512c2.249-3.799,5.606-6.4,9.461-8.405
	c6.238-3.246,12.914-4.974,19.896-5.537c7.565-0.61,15.096-0.366,22.49,1.507c4.285,1.085,8.312,2.776,11.744,5.657
	c4.473,3.749,6.776,8.647,6.812,14.374c0.139,21.477,0.096,42.951,0.143,64.428c0.002,0.799-0.248,0.983-1.021,0.98
	c-8.035-0.025-16.074-0.023-24.113-0.001c-0.716,0.002-0.973-0.146-0.941-0.915C277.736,167.562,277.695,165.698,277.695,163.6z
	 M277.695,126.393c-4.793,2.104-9.25,4.373-13.287,7.408c-2.151,1.618-4.033,3.483-5.732,5.581
	c-4.229,5.226-1.988,13.343,1.693,16.599c1.592,1.406,3.359,1.906,5.419,1.521c1.621-0.307,3.149-0.857,4.549-1.734
	c1.521-0.951,2.949-2.072,4.539-2.887c2.31-1.18,2.97-2.861,2.894-5.445C277.561,140.484,277.695,133.527,277.695,126.393z"/>

</svg>

</a></div>

<ul class="links">
  
      
      
      
      
      
      <li><a href="/" class="">홈</a></li>
  
      
      
      
      
      
      <li><a href="https://github.com/JuliaLang/julia" class="">소스코드</a></li>
  
      
      
      
      
      
      <li><a href="/downloads/" class="">다운로드</a></li>
  
      
      
      
      
      
      <li><a href="/ko/" class="">문서</a></li>
  
      
      
      
      
      
      <li><a href="http://pkg.julialang.org/" class="">패키지</a></li>
  
      
      
      
      
      
      <li><a href="/blog/" class="active">블로그</a></li>
  
      
      
      
      
      
      <li><a href="/community/" class="">커뮤니티</a></li>
  
      
      
      
      
      
      <li><a href="/ecosystems" class="">생태계</a></li>
  
      
      
      
      
      
      <li><a href="/learning/" class="">배우기</a></li>
  
      
      
      
      
      
      <li><a href="/teaching/" class="">강의</a></li>
  
      
      
      
      
      
      <li><a href="/publications/" class="">논문</a></li>
  
      
      
      
      
      
      <li><a href="/soc/ideas-page.html" class="">GSoC</a></li>
  
      
      
      
      
      
      <li><a href="http://juliacon.org" class="">줄리아콘</a></li>
  
</ul>

<!--

<style>
.banner-box .header {
  font-size: 1.5em;
}
@media (min-width: 830px) {
  .banner-box {
    float:left;
    width:50%;
  }
}
</style>

<div style="text-align:center">

<div class="banner-box">
<div class="header">JuliaCon 2016</div>
<p>
  Held on June 21<sup>st</sup> - 25<sup>th</sup> at MIT<br>
  <a href="http://juliacon.org">talks</a> |
  <a href="https://www.youtube.com/playlist?list=PLP8iPy9hna6SQPwZUDtAM59-wPzCPyD_S">videos</a>
</p>
</div>

<div class="banner-box">
<div class="header">Google Summer of Code</div>
<p>
  Julia gets 12 slots in the Google Summer of Code!<br />
  <a href="https://summerofcode.withgoogle.com/organizations/6453977159827456/">projects</a> |
  <a href="/soc/ideas-page.html">ideas list</a>
</p>
</div>

<div style="clear:both; border-top: 1px solid #ddd; margin-bottom:30px;"></div>


</div>
-->


<div id="blogpost">
  <h1>JSoC 2015 project: NullableArrays.jl</h1>

  <p class="metadata">
    <span class="timestamp">16 Oct 2015</span>
    
    &nbsp;|&nbsp;
    <span class="author">David Gold</span>
    
  </p>

  <p>My project under the 2015 <a href="http://julialang.org/jsoc">Julia Summer of Code</a> program has been to develop the <a href="https://github.com/JuliaStats/NullableArrays.jl">NullableArrays</a> package, which provides the <code class="highlighter-rouge">NullableArray</code> data type and its respective interface. I first encountered Julia earlier this year as a suggestion for which language I ought to learn as a matriculating PhD student in statistics. This summer has been an incredible opportunity for me both to develop as a young programmer and to contribute to an open-source community as full of possibility as Julia’s. I’d be remiss not to thank <a href="http://www-math.mit.edu/~edelman/">Alan Edelman</a>’s group at MIT, <a href="http://numfocus.org/">NumFocus</a>, and the <a href="https://www.moore.org/">Gordon &amp; Betty Moore Foundation</a> for their financial support, <a href="https://github.com/johnmyleswhite/">John Myles White</a> for his mentorship and guidance, and many others of the Julia community who have helped to contribute both to the package and to my edification as a programmer over the summer. Much of my work on this project was conducted at the <a href="https://www.recurse.com">Recurse Center</a>, where I received the support of an amazing community of self-directed learners.</p>

<h2 id="the-nullablearray-data-structure">The <code class="highlighter-rouge">NullableArray</code> data structure</h2>

<p><code class="highlighter-rouge">NullableArray</code>s are array structures that efficiently represent missing values without incurring the performance difficulties that face <code class="highlighter-rouge">DataArray</code> objects, which have heretofore been used to store data that include missing values. The core issue responsible for <code class="highlighter-rouge">DataArray</code>s performance woes concerns the way in which the former represent missing values, i.e. through a token <code class="highlighter-rouge">NA</code> object of token type <code class="highlighter-rouge">NAType</code>. In particular, indexing into, say, a <code class="highlighter-rouge">DataArray{Int}</code> can return an object either of type <code class="highlighter-rouge">Int</code> or of type <code class="highlighter-rouge">NAType</code>. This design does not provide sufficient information to Julia’s type inference system at JIT-compilation time to support the sort of static analysis that Julia’s compiler can otherwise leverage to emit efficient machine code. We can illustrate as much through following example, in which we calculate the sum of five million random <code class="highlighter-rouge">Float64</code>s stored in a <code class="highlighter-rouge">DataArray</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; using DataArrays
# warnings suppressed…

julia&gt; A = rand(5_000_000);

julia&gt; D = DataArray(A);

julia&gt; function f(D::AbstractArray)
           x = 0.0
           for i in eachindex(D)
               x += D[i]
           end
           x
       end
f (generic function with 1 method)

julia&gt; f(D);

julia&gt; @time f(D)
  0.163567 seconds (10.00 M allocations: 152.598 MB, 9.21% gc time)
2.500102419334644e6
</code></pre></div></div>

<p>Looping through and summing the elements of <code class="highlighter-rouge">D</code> is over twenty times slower and allocates far more memory than running the same loop over <code class="highlighter-rouge">A</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; f(A);

julia&gt; @time f(A)
  0.007465 seconds (5 allocations: 176 bytes)
2.500102419334644e6
</code></pre></div></div>

<p>This is because the code generated for <code class="highlighter-rouge">f(D)</code> must assume that <code class="highlighter-rouge">getindex(D, i)</code> for an arbitrary index <code class="highlighter-rouge">i</code> may return an object either of type <code class="highlighter-rouge">Float64</code> or of type <code class="highlighter-rouge">NAType</code> and hence must “box” every object returned from indexing into <code class="highlighter-rouge">D</code>. The performance penalty incurred by this requirement is reflected in the comparison above. (The interested reader can find more about these issues <a href="http://www.johnmyleswhite.com/notebook/2014/11/29/whats-wrong-with-statistics-in-julia/">here</a>.)</p>

<p>On the other hand, <code class="highlighter-rouge">NullableArray</code>s are designed to support the sort of static analysis used by Julia’s type inference system to generate efficient machine code. The crux of the strategy is to use a single type — <code class="highlighter-rouge">Nullable{T}</code> — to represent both missing and present values. <code class="highlighter-rouge">Nullable{T}</code> objects are specialized containers that hold precisely either one or zero values. A <code class="highlighter-rouge">Nullable</code> that wraps, say, <code class="highlighter-rouge">5</code> can be taken to represent a present value of <code class="highlighter-rouge">5</code>, whereas an empty <code class="highlighter-rouge">Nullable{Int}</code> can represent a missing value that, if it had been present, would have been of type <code class="highlighter-rouge">Int</code>. Crucially, both such objects are of the same type, i.e. <code class="highlighter-rouge">Nullable{Int}</code>. Interested readers can hear a bit more on these design considerations in my <a href="https://www.youtube.com/watch?v=2v5k28F80BQ">JuliaCon 2015 lighting talk</a>.</p>

<p>Here is the result of running the same loop over a comparable <code class="highlighter-rouge">NullableArray</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; using NullableArrays

julia&gt; X = NullableArray(A);

julia&gt; function f(X::NullableArray)
           x = Nullable(0.0)
           for i in eachindex(X)
               x += X[i]
           end
           x
       end
f (generic function with 1 method)

julia&gt; f(X);

julia&gt; @time f(X)
  0.009812 seconds (5 allocations: 192 bytes)
Nullable(2.500102419334644e6)
</code></pre></div></div>

<p>As can be seen, naively looping over a <code class="highlighter-rouge">NullableArray</code> is on the same order of magnitude as naively looping over a regular <code class="highlighter-rouge">Array</code> in terms of both time elapsed and memory allocated. Below is a set of plots (drawn with <a href="https://github.com/dcjones/Gadfly.jl">Gadfly.jl</a>) that visualize the results of running 20 benchmark samples of <code class="highlighter-rouge">f</code> over both <code class="highlighter-rouge">NullableArray</code> and <code class="highlighter-rouge">DataArray</code> arguments each consisting of 5,000,000 random <code class="highlighter-rouge">Float64</code> values and containing either zero null entries or approximately half randomly chosen null entries.</p>

<p><img src="/images/2015-10-03-nullablearrays-images/f_plot.png" alt="" /></p>

<p>Of course, it is possible to bring the performance of such a loop over a <code class="highlighter-rouge">DataArray</code> up to par with that of a loop over an <code class="highlighter-rouge">Array</code>. But such optimizations generally introduce additional complexity that oughtn’t to be required to achieve acceptable performance in such a simple task. Considerably more complex code can be required to achieve performance in more involved implementations, such as that of <code class="highlighter-rouge">broadcast!</code>. We intend for <code class="highlighter-rouge">NullableArray</code>s to to perform well under involved tasks involving missing data while requiring as little interaction with <code class="highlighter-rouge">NullableArray</code> internals as possible. This includes allowing users to leverage extant implementations without sacrificing performance. Consider for instance the results of relying on Base’s implementation of <code class="highlighter-rouge">broadcast!</code> for <code class="highlighter-rouge">DataArray</code> and <code class="highlighter-rouge">NullableArray</code> arguments (i.e., having omitted the respective <code class="highlighter-rouge">src/broadcast.jl</code> from each package’s source code). Below are plots that visualize the results of running 20 benchmark samples of <code class="highlighter-rouge">broadcast!(dest, src1, src2)</code>, where <code class="highlighter-rouge">dest</code> and <code class="highlighter-rouge">src2</code> are <code class="highlighter-rouge">5_000_000 x 2</code> <code class="highlighter-rouge">Array</code>s, <code class="highlighter-rouge">NullableArray</code>s or <code class="highlighter-rouge">DataArray</code>s, and <code class="highlighter-rouge">src1</code> is a <code class="highlighter-rouge">5_000_000 x 1</code> <code class="highlighter-rouge">Array</code>, <code class="highlighter-rouge">NullableArray</code> or <code class="highlighter-rouge">DataArray</code>. As above, the <code class="highlighter-rouge">NullableArray</code> and <code class="highlighter-rouge">DataArray</code> arguments are tested in cases with either zero or approximately half null entries:</p>

<p><img src="/images/2015-10-03-nullablearrays-images/bcast_plot.png" alt="" /></p>

<p>We have designed the <code class="highlighter-rouge">NullableArray</code> type to feel as much like a regular <code class="highlighter-rouge">Array</code> as possible. However, that <code class="highlighter-rouge">NullableArray</code>s return <code class="highlighter-rouge">Nullable</code> objects is a significant departure from both <code class="highlighter-rouge">Array</code> and <code class="highlighter-rouge">DataArray</code> behavior. Arguably the most important issue is to support user-defined functions that lack methods for <code class="highlighter-rouge">Nullable</code> arguments as they interact with <code class="highlighter-rouge">Nullable</code> and <code class="highlighter-rouge">NullableArray</code> objects. Throughout my project I have also worked to develop interfaces that make dealing with <code class="highlighter-rouge">Nullable</code> objects user-friendly and safe.</p>

<p>Given a method <code class="highlighter-rouge">f</code> defined on an argument signature of types <code class="highlighter-rouge">(U1, U2, …, UN)</code>, we would like to provide an accessible, safe and performant way for a user to call <code class="highlighter-rouge">f</code> on an argument of signature <code class="highlighter-rouge">(Nullable{U1}, Nullable{U2}, …, Nullable{UN})</code> without having to extend <code class="highlighter-rouge">f</code> herself. Doing so should return <code class="highlighter-rouge">Nullable(f(get(u1), get(u1), …, get(un)))</code> if each argument is non-null, and should return an empty <code class="highlighter-rouge">Nullable</code> if any argument is null. Systematically extending an arbitrary method <code class="highlighter-rouge">f</code> over <code class="highlighter-rouge">Nullable</code> argument signatures is often referred to as “lifting” <code class="highlighter-rouge">f</code> over the <code class="highlighter-rouge">Nullable</code> arguments.</p>

<p>NullableArrays offers keyword arguments for certain methods such as <code class="highlighter-rouge">broadcast</code> and <code class="highlighter-rouge">map</code> that direct the latter methods to lift passed function arguments over <code class="highlighter-rouge">NullableArray</code> arguments:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>julia&gt; X = NullableArray(collect(1:10), rand(Bool, 10))
10-element NullableArray{Int64,1}:
 #NULL
 #NULL
 #NULL
     4
     5
     6
     7
     8
 #NULL
    10

julia&gt; f(x::Int) = 2x
f (generic function with 2 methods)

julia&gt; map(f, X)
ERROR: MethodError: `f` has no method matching f(::Nullable{Int64})
Closest candidates are:
  f(::Any, ::Any)
 [inlined code] from /Users/David/.julia/v0.4/NullableArrays/src/map.jl:93
 in _F_ at /Users/David/.julia/v0.4/NullableArrays/src/map.jl:124
 in map at /Users/David/.julia/v0.4/NullableArrays/src/map.jl:172

julia&gt; map(f, X; lift=true)
10-element NullableArray{Int64,1}:
 #NULL
 #NULL
 #NULL
     8
    10
    12
    14
    16
 #NULL
    20
</code></pre></div></div>

<p>I also plan to release shortly a small package that will offer a more flexible “lift” macro, which will be able to lift function calls over <code class="highlighter-rouge">Nullable</code> arguments within a variety of expression types.</p>

<p>We hope that the new NullableArrays package will help to support not only Julia’s statistical computing ecosystem as it moves forward but also any endeavor that requires an efficient, developed interface for handling arrays of <code class="highlighter-rouge">Nullable</code> objects. Please do try the package, submit feature requests, report bugs, and, if you’re interested, submit a PR or two. Happy coding!</p>


</div>



    <div class="footer">
      Julia is a <a href="https://numfocus.org/projects/index.html">NumFocus project</a>.
      We thank <a href="https://fastly.com">Fastly</a> for their generous infrastructural support.
      
      <a href="https://github.com/juliakorea/translate-home/edit/master/src/blog/_posts/2015-10-16-nullablearrays.md">Edit this page on GitHub.</a>
    </div>

    <!-- Add "contribute" link to the Transifex language dropdown -->
    <script>
      // Create a link element for the translation prompt
      var txPromptLink = document.createElement( "a" );
      txPromptLink.href = "https://www.transifex.com/julialang-i18n/julialang-web/";
      txPromptLink.appendChild( document.createTextNode( "Add your language!" ) );
      txPromptLink.style.fontWeight = "bold";

      // Wrap the translation prompt link in a list item element
      var txPrompt = document.createElement( "li" );
      txPrompt.appendChild( txPromptLink );

      // Add the translation prompt list item to the list of languages
      document.getElementById( "tx-live-lang-picker" ).appendChild( txPrompt );
    </script>

<!--Flipcause Integration v3.0// Flipcause Integration Instructions:
    Install the following code block once in the website Header (after <head> tag) -->

<style>

  .fc-black_overlay{
  display:none; position: fixed; z-index:1000001; top: 0%;left: 0%;width: 100%;height: 100%;
  background-color: black; filter: alpha(opacity=50); cursor:pointer; opacity:0.5;
  }

  .fc-white_content {
  opacity:1; display:none; margin-top: -320px; margin-left: -485px; width:970px; height:640px;
  position:fixed; top:50%; left:50%; border: none;z-index:1000002;overflow: auto;
  }

  .fc-main-box{
  opacity:1; display:none; margin:15px auto 0 auto; width:930px; position:relative; z-index:1000003;
  }

  .fc-widget_close{
  opacity:1; content:url(http://i1338.photobucket.com/albums/o691/WeCause/X_zpse4a7e538.png);
  position:absolute; z-index=1000004; right:-16px; top:-16px; display:block; cursor:pointer;
  }

  .floating_button{
  display: block; margin-top: 0px; margin-left: 0px; width:auto ; height: auto;
  position:fixed; z-index:999999; overflow: auto;
  }

  @keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-moz-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-webkit-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @-o-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }


  @-ms-keyframes backfadesin {
  from { opacity:0; }
  to {opacity:.5;}
  }

  @keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; transform: translateY(20px);}
  100% {opacity: 1; transform: translateY(0);}
  }

  @-moz-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -moz-transform: translateY(20px);}
  100% {opacity: 1; -moz-transform: translateY(0);}
  }

  @-webkit-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -webkit-transform: translateY(20px);}
  100% {opacity: 1; -webkit-transform: translateY(0);}
  }

  @-o-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -o-transform: translateY(20px);}
  100% {opacity: 1; -o-transform: translateY(0);}
  }

  @-ms-keyframes fadesin {
  0%{ opacity:0; }
  50%{ opacity:0; }
  75% {opacity: 0; -ms-transform: translateY(20px);}
  100% {opacity: 1; -ms-transform: translateY(0);}
  }

</style>

<script>

  function open_window(cause_id) {
  var  protocol=String(document.location.protocol);
  var new_url;
  if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
  new_url="https://www.flipcause.com/widget/"+cause_id
  window.open(new_url);
  }

  else {
  document.getElementById("fc-fade").style.display = "block";
  document.getElementById("fc-fade").style.webkitAnimation = "backfadesin 1s";
  document.getElementById("fc-fade").style.animation = "backfadesin 1s";
  document.getElementById("fc-fade").style.mozAnimation = "backfadesin 1s";
  document.getElementById("fc-light").style.display = "block";
  document.getElementById("fc-light").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-light").style.animation = "fadesin 1.5s";
  document.getElementById("fc-light").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-main").style.display = "block";
  document.getElementById("fc-main").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-main").style.animation = "fadesin 1.5s";
  document.getElementById("fc-main").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-close").style.display = "block";
  document.getElementById("fc-close").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-close").style.animation = "fadesin 1.5s";
  document.getElementById("fc-close").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.display = "block";
  document.getElementById("fc-myFrame").style.webkitAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.animation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").style.mozAnimation = "fadesin 1.5s";
  document.getElementById("fc-myFrame").src="https://www.flipcause.com/widget/"+cause_id;
  }
  }


  function close_window() {
  document.getElementById("fc-fade").style.display="none";
  document.getElementById("fc-light").style.display="none";
  document.getElementById("fc-main").style.display="none";
  document.getElementById("fc-close").style.display="none";
  document.getElementById("fc-myFrame").style.display="none";
  }

</script>

<div id="fc-fade" class="fc-black_overlay" onclick="close_window()"></div>
<div id="fc-light" class="fc-white_content">
  <div id="fc-main" class="fc-main-box">
    <div id="fc-close" class="fc-widget_close" onclick="close_window()"></div>
    <iframe id="fc-myFrame" iframe height="580" width="925"
            style="border: 0; border-radius: 5px 5px 5px 5px; box-shadow: 0 0 8px rgba(0, 0, 0, 0.5);"
            scrolling="no" src=""></iframe>
  </div>
</div>

<!--END Flipcause Main Integration Code-->

    <div style="background: #ccc; border-radius: 0px 0px 0px 0px; font-weight: normal;
                font-family: Arial, Helvetica, sans-serif; border: none; box-shadow: none;
                left: 50%; margin-left: -72.5px; clear: both; display: block; width: 145px;
                height: 45px; line-height: 2.8; position: relative; font-size: 16px;
                text-align: center; cursor: pointer; color: #fff; text-decoration: none; z-index:1"
         onclick="open_window('MjI1Nw==')">
      Donate Now
    </div>
    
  </div><!-- main wrapper -->
</body>
</html>
